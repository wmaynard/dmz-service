@inherits TowerPortal.Views.Shared.PortalView
@{
    ViewData["Title"] = "Chat Announcements";
}

<div class="announcements-page-container">
    <div class="player-chat-container">
        @Html.ActionLink(linkText: "View player specific bans", actionName: "Player", controllerName: "Chat", routeValues: new {}, htmlAttributes: new {})
    </div>
    <div class="player-chat-container">
        @Html.ActionLink(linkText: "View reports", actionName: "Reports", controllerName: "Chat", routeValues: new {}, htmlAttributes: new {})
    </div>
    
    <h2>@ViewData["Title"]</h2>
    
    <div class="error-container">
        <h4 style="color: @(WasSuccessful ? "darkgreen" : "red")">@(StatusMessage)</h4>
    </div>
    
    <div class="announcements-container">
        <h3>Chat Announcements</h3>
        <table id="chatAnnouncements" class="chat-announcements">
            <tr>
                <td class="id">Id</td>
                <td class="aid">Aid</td>
                <td class="text">Text</td>
                <td class="timestamp">Timestamp</td>
                <td class="expiration">Expiration</td>
                <td class="type">Type</td>
                <td class="announcement-expire">Expire</td>
            </tr>
            @foreach (Announcement announcement in (List<Announcement>) ViewData["Announcements"])
            {
                <tr>
                    <td>@announcement.Id</td>
                    <td>@announcement.Aid</td>
                    <td>@announcement.Text</td>
                    <td>@DateTimeOffset.FromUnixTimeSeconds(@announcement.Timestamp)</td>
                    <td>@DateTimeOffset.FromUnixTimeSeconds(@announcement.Expiration)</td>
                    <td>@announcement.Type</td>
                    <td>
                        <form class="chat-announcement-form" method="post" asp-controller="Chat" asp-action="AnnouncementsExpire">
                            <div class="messageId invisible">
                                <input id="messageId" class="messageId" type="text" name="messageId" value="@announcement.Id)">
                            </div>
                            <button id="expireButton" class="expireButton" disabled="@(!Permissions.Chat.Edit)" type="submit">Expire</button>
                        </form>
                    </td>
                </tr>
            }
        </table>
    </div>
</div>
@using TowerPortal.Extensions
@{
    ViewData["Title"] = "Ban players";
}

<div class="token-page-container">
    <h2>@TempData["Title"]</h2>
    
    <div class="error-container">
        @if (TempData["Failure"] != null)
        {
            <h4 style="color: red">@TempData["Success"]</h4>
        }
        else
        {
            <h4 style="color: darkgreen">@TempData["Success"]</h4>
        }
    </div>

    <div class="ban-container">
        <form class="ban-form" method="post" asp-controller="Token" asp-action="Ban">
            <div class="playerIds">
                <label for="playerIds" class="playerIds">Player IDs* (separated by "," or "|")</label>
                <input id="playerIds" class="playerIds" type="text" name="playerIds" placeholder="ex: 6140bd998caf79f468e6f8a6, 60e7ea01907cf6e93a7578c2" required>
            </div>
            <div class="actionBan">
                <input id="actionBan" class="actionBan" type="radio" name="action" value="ban" checked>
                <label for="actionBan" class="actionBan">Ban</label>
            </div>
            <div class="unbanTime">
                <label for="unbanTime" class="unbanTime">Unban Time (UTC) (leave blank if permanent)</label>
                <input id="unbanTime" class="unbanTime" type="datetime-local" name="unbanTime">
            </div>
            <div class="actionUnban">
                <input id="actionUnban" class="actionUnban" type="radio" name="action" value="unban">
                <label for="actionUnban" class="actionUnban">Unban</label>
            </div>
            <div class="actionLogout">
                <input id="actionLogout" class="actionLogout" type="radio" name="action" value="logout">
                <label for="actionLogout" class="actionLogout">Logout</label>
            </div>
            <div class="note">
                <label for="note" class="note">Internal Note</label>
                <input id="note" class="note" type="text" name="note" placeholder="Note">
            </div>
            <button id="banButton" class="banButton" disabled="@(!ViewData.GetPermissions().EditToken)" type="submit">Confirm</button>
        </form>
    </div>
    
    <div class="log-container">
        @if (ViewData["TokenLogs"] != null)
        {
            <table id="tokenLogs" class="log-table">
                <tr>
                    <td id="actorLog">Actor</td>
                    <td id="actionLog">Action</td>
                    <td id="unbanTimeLog">Unban Time</td>
                    <td id="timestampLog">Timestamp</td>
                    <td id="targetLog">Target</td>
                    <td id="noteLog">Note</td>
                </tr>
                @foreach (TokenLog data in (List<TokenLog>) ViewData["TokenLogs"])
                {
                    <tr>
                        <td>@data.Actor</td>
                        <td>@data.Action</td>
                        @if (@data.UnbanTime != null)
                        {
                            <td>@DateTimeOffset.FromUnixTimeSeconds(@data.UnbanTime ?? default(long))</td>
                        }
                        else
                        {
                            <td></td>
                        }
                        <td>@DateTimeOffset.FromUnixTimeSeconds(@data.Timestamp)</td>
                        <td>@data.Target</td>
                        <td>@data.Note</td>
                    </tr>
                }
            </table>
        }
    </div>
</div>